세 번째 발표자: 대용량 ETL 작업을 위한 배치 처리 시스템 운영 및 관리

Executive Summary

세 번째 발표자는 대용량 ETL(Extract, Transform, Load) 작업을 효율적으로 운영하고 관리하기 위한 배치 처리 시스템에 대해 발표했습니다. 실무 환경에서는 수십 개에서 수천 개에 달하는 배치 작업의 복잡성과 상호 의존성을 관리하는 것이 핵심 과제이며, 특히 작업의 선후 관계를 명확히 파악하고 오류 발생 시 신속하게 대응하는 것이 중요합니다.

발표자는 ETL 작업 구현을 위해 스프링 생태계의 **스프링 배치(Spring Batch)**를 활용하고, 이들 작업의 실행과 관리를 위해 전통적인 스케줄러 방식의 한계를 넘어 젠킨스(Jenkins)의 파이프라인(Pipeline) 기능을 도입하는 방안을 제시했습니다. 젠킨스 파이프라인은 복잡하게 얽힌 배치 작업의 흐름과 실패 지점을 시각적으로 명확하게 보여주어, 문서 기반의 수동적 관리에 비해 운영 효율성과 안정성을 크게 향상시킬 수 있습니다. 다만, 이 방식을 도입할 경우 높은 CPU 사용량으로 인한 시스템 부하를 방지하기 위해 CI/CD용 젠킨스 서버와 배치 처리용 젠킨스 서버를 반드시 분리하여 운영해야 한다는 점을 핵심 고려사항으로 강조했습니다.


--------------------------------------------------------------------------------


1. 배치 처리의 필요성과 기술적 기반

실무 환경에서는 소량의 데이터를 처리하는 것이 아니라, 대용량 데이터를 추출(Extract), 변환(Transform), 적재(Load)하는 ETL 작업을 한 번에 묶어서 처리하는 배치(Batch) 작업이 필수적입니다. 학부생 수준의 포트폴리오에서는 접하기 어렵지만, 거의 모든 기업에서 대규모 데이터 처리를 위해 배치 시스템을 운영하고 있습니다.

발표자는 스프링(Spring) 진영에서 개발을 진행하고 있으며, 다음과 같은 기술을 기반으로 ETL 작업을 수행합니다.

* 스프링 배치(Spring Batch): 스프링 생태계에서 제공하는 프레임워크로, 대용량 ETL 작업을 보다 편리하게 구현할 수 있도록 지원합니다. 기존 스프링 문법과 호환성이 높아 개발자들이 쉽게 사용할 수 있습니다.

2. 배치 작업 관리의 복잡성과 도전 과제

배치 작업의 구현만큼이나 중요한 것은 수많은 작업을 어떻게 안정적으로 실행시키고 관리하느냐의 문제입니다.

선후 관계의 중요성

한 팀에서 수십 개, 기업 전체로는 수백, 수천 개의 배치 작업이 존재할 수 있습니다. 이 작업들은 서로 독립적이지 않고 **선후 관계(dependency)**를 가지는 경우가 많습니다.

* 예시: '종이비행기 1,000개를 접는 작업'이 '접은 비행기를 날리는 작업'보다 반드시 먼저 실행되어야 합니다. 만약 실행 순서가 뒤바뀐다면 시스템 전체에 문제가 발생합니다.
* 개발자는 각 배치의 선행 작업이 무엇인지 명확히 인지하고 관리해야 합니다.

전통적인 관리 방식의 한계

많은 기업에서는 배치 작업의 목록, 실행 시간(Cron 표현식), 선행 조건 등을 엑셀(Excel)이나 독스(Docs) 같은 문서로 정리하여 관리합니다.

* 문제점: 신입사원이나 해당 도메인 경험이 부족한 인력이 문서를 보고 작업의 전체 흐름과 의존성을 파악하기에는 한계가 명확합니다. 이는 잠재적인 운영 리스크로 이어질 수 있습니다.

3. Jenkins를 활용한 배치 오케스트레이션

발표자의 팀은 위와 같은 관리의 어려움을 해결하기 위해 배치 실행 및 관리 도구로 **젠킨스(Jenkins)**로의 마이그레이션을 추진하고 있습니다. 젠킨스는 주로 CI/CD 도구로 알려져 있지만, 배치 오케스트레이션에도 강력한 기능을 제공합니다.

핵심 기능: 파이프라인(Pipeline)

젠킨스 도입의 가장 큰 이유는 파이프라인 기능 때문입니다.

* 시각적 명확성: 여러 단계로 구성된 배치 작업의 전체 흐름을 시각적으로 보여줍니다.
* 신속한 오류 파악: 여러 작업 중 어느 단계(step)에서 실패했는지 한눈에 파악할 수 있어 신속한 원인 분석과 대응이 가능합니다.
* 유연성: 플러그인 생태계가 매우 발달해 있어, 실행 시점에 파라미터를 동적으로 전달하거나 스케줄러 자체에 환경 변수를 설정하는 등 다양한 요구사항을 유연하게 처리할 수 있습니다.

국내에서는 토스, 인프랩, 우아한형제들 같은 기업들이 젠킨스를 배치 관리 도구로 활용하고 있는 것으로 알려져 있습니다.

4. Jenkins 도입 시 고려사항 및 대안

젠킨스를 배치 관리 시스템으로 도입할 때에는 다음과 같은 점들을 반드시 고려해야 합니다.

단점 및 주의사항

1. 별도의 서버 필요: 젠킨스 운영을 위한 서버를 별도로 구축하고 관리해야 하므로 추가적인 인적, 물적 리소스가 소모됩니다.
2. CI/CD 서버와의 분리: 가장 중요한 고려사항으로, 배치 작업용 젠킨스 서버와 기존 CI/CD용 젠킨스 서버는 반드시 분리해야 합니다.
  * 이유: 수십 개의 배치가 동시에 실행되면 CPU 사용량이 급증하여 서버에 과부하가 걸릴 수 있습니다. 이로 인해 젠킨스 서버가 중단되면, 배포 파이프라인까지 함께 멈추는 심각한 운영 장애로 이어질 수 있습니다.
  * 권장 방식: 배치 전용 젠킨스 서버를 별도로 구축하여 2대로 운영하는 것이 일반적입니다.

대안 솔루션

* 아파치 에어플로우(Apache Airflow): 데이터 웨어하우스와 같이 훨씬 더 큰 규모의 데이터 환경에서 배치 작업을 관리하기 위해 널리 사용되는 표준적인 도구입니다.
* ChatGPT AI Agent Builder: 최근 발표된 솔루션으로, 자동화 워크플로우 중간에 사람의 승인 단계를 포함할 수 있어 향후 배치 관리의 새로운 대안이 될 가능성이 있습니다.

5. Q&A: 쿠버네티스 CronJob 대신 Jenkins를 사용하는 이유

발표자는 '쿠버네티스 환경이라면 CronJob을 사용하는 것이 일반적이지 않은가?'라는 질문에 대해, 소속된 팀의 특수한 환경 때문이라고 답변했습니다.

* 규제 준수: 결제 시스템을 개발하는 팀으로서 전자금융거래법의 적용을 받습니다.
* 인프라 분리: 이로 인해 젠킨스가 운영되는 환경은 쿠버네티스 클러스터와 분리된 별도의 "공유 영역(shared area)"에 위치하고 있어, 보안 및 규제 준수를 위해 쿠버네티스 CronJob 대신 젠킨스를 채택했습니다.
